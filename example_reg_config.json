{
    "_comment": "1BR 1Slot_TX 1Slot_RX 扫频模式 - 寄存器采样配置",
    "_width_info": "width 支持 1-32 字节连续读取，超过 32 字节时客户端自动拆分",
    "_post_process_info": {
        "_说明": "post_process 支持: func(调用predefined_funcs), transform(表达式), split(位域拆分)",
        "_用法示例": "{ \"func\": \"reg_freq_khz\" }"
    },
    "predefined_funcs": {
        "_说明": "预定义函数，可在 post_process.func 中引用",
        "reg_freq_khz": {
            "type": "auto_band_freq",
            "description": "BR频率计算(自动判断5G/2G)，返回 (freq_khz, band)",
            "extract": {
                "rf_ch_int": "x & 0xff",
                "rf_ch_frac": "((x >> 24) & 0xff) | (((x >> 16) & 0xff) << 8) | (((x >> 8) & 0xff) << 16)"
            },
            "freq_formula": "((rf_multi * rf_ch_int + (rf_multi * rf_ch_frac) // 16777216) + 1) & 0xfffffffe",
            "bands": {
                "5G": {"rf_multi": 60000, "min": 5000000, "max": 6000000},
                "2G": {"rf_multi": 30000, "min": 2000000, "max": 3000000}
            }
        }
    },
    "name": "example_regs",
    "description": "示例寄存器配置",
    "host": "192.168.10.100",
    "port": 12345,
    "sample_div": 1,
    "buffer_depth": 100,
    "_irq_mask_bits": {
        "RX_BR_END": "0x0001",
        "TX_BR_END": "0x0002",
        "CSMA_START_ENC": "0x0004",
        "FSM_STATE_CHG": "0x0008",
        "FSM_TRX": "0x0010",
        "SLOT_SOP": "0x0020",
        "TX_PRE_ENC": "0x0040",
        "RX_RDOUT": "0x0080",
        "FCH_DEC": "0x0100",
        "FREQ_SWEEP": "0x0200",
        "ALL": "0xFFFF"
    },
    "_register_base": {
        "BB_REG_BASE": "0x60680000",
        "PAGE0": "0x60680000",
        "PAGE1": "0x60680100",
        "PAGE2": "0x60680200",
        "PAGE3": "0x60680300",
        "PAGE4": "0x60680400",
        "PAGE5": "0x60680500"
    },
    "items": [
        {
            "page": 4,
            "offset": "0x08",
            "width": 4,
            "irq_mask": "0x0020",
            "name": "slot0_gain0",
            "description": "slot0 gain ch0 (from BB_REG_PAGE4_08 USER0_GAIN high16)",
            "post_process": {
                "transform": "(((x >> 24) & 0xff) + ((x >> 16) & 0xff))"
            }
        },
        {
            "page": 4,
            "offset": "0x0C",
            "width": 4,
            "irq_mask": "0x0020",
            "name": "slot0_gain1",
            "description": "slot0 gain ch1 (from BB_REG_PAGE4_0C USER0_GAIN_1 low16)",
            "post_process": {
                "transform": "(((x >> 8) & 0xff) + (x & 0xff))"
            }
        },
        {
            "page": 5,
            "offset": "0xFC",
            "width": 4,
            "irq_mask": "0x0020",
            "name": "FCH_STATE",
            "description": "FCH State (BB_REG_PAGE5_FC[23])",
            "post_process": {
                "transform": "(x >> 23) & 0x1"
            }
        },
        {
            "page": 4,
            "offset": "0xE0",
            "width": 4,
            "irq_mask": "0x0020",
            "name": "USER_INDEX",
            "description": "User Index (BB_REG_PAGE4_E0[3:2])",
            "post_process": {
                "transform": "(x >> 2) & 0x3"
            }
        },
        {
            "page": 4,
            "offset": "0x70",
            "width": 2,
            "irq_mask": "0x0020",
            "name": "USR0_SNR",
            "description": "User0 raw SNR (BB_REG_PAGE4_70)",
            "post_process": {
                "transform": "10 * math.log10(x / 64) if x > 0 else 0"
            }
        },
        {
            "page": 4,
            "offset": "0xCC",
            "width": 4,
            "irq_mask": "0x0020",
            "name": "USR0_LDPC_STAT",
            "description": "LDPC stats for user0 (ERR low16, NUM high16)",
            "post_process": {
                "split": [
                    {"name": "USR0_LDPC_ERR", "bit_range": [15, 0]},
                    {"name": "USR0_LDPC_NUM", "bit_range": [31, 16]}
                ]
            }
        },
        {
            "page": 5,
            "offset": "0xF8",
            "width": 4,
            "irq_mask": "0x0020",
            "name": "HARQ_REQ_U0",
            "description": "HARQ request count for user0 (bits 19:16 of BB_REG_PAGE5_F8)",
            "post_process": {
                "transform": "(x >> 16) & 0xF"
            }
        },
        {
            "page": 4,
            "offset": "0xF0",
            "width": 4,
            "irq_mask": "0x0020",
            "name": "HARQ_TIMES_U0",
            "description": "HARQ retry times for user0 (bits 19:16 of BB_REG_PAGE4_F0)",
            "post_process": {
                "transform": "(x >> 16) & 0xF"
            }
        },
        {
            "page": 0,
            "offset": "0xD0",
            "width": 4,
            "irq_mask": "0x0003",
            "name": "FREQ_BR",
            "description": "BR 频率 (自动判断 5G/2G 频段)，单位 kHz",
            "post_process": {
                "func": "reg_freq_khz"
            }
        },
        {
            "page": 0,
            "offset": "0xD4",
            "width": 4,
            "irq_mask": "0x0003",
            "name": "FREQ_FS",
            "description": "BR FS 频率 (自动判断 5G/2G)，单位 kHz (BB_REG_PAGE0_D4)",
            "post_process": { "func": "reg_freq_khz" }
        },
        {
            "page": 0,
            "offset": "0xD8",
            "width": 4,
            "irq_mask": "0x0003",
            "name": "FREQ_DW",
            "description": "BR DW 频率开始 (自动判断 5G/2G)，单位 kHz (BB_REG_PAGE0_D8)",
            "post_process": { "func": "reg_freq_khz" }
        },
        {
            "page": 0,
            "offset": "0xE8",
            "width": 4,
            "irq_mask": "0x0003",
            "name": "FREQ_UP",
            "description": "BR UP 频率开始 (自动判断 5G/2G)，单位 kHz (BB_REG_PAGE0_E8)",
            "post_process": { "func": "reg_freq_khz" }
        },
        {
            "page": 0,
            "offset": "0xF8",
            "width": 4,
            "irq_mask": "0x0003",
            "name": "FREQ_CSMA",
            "description": "BR CSMS 频率 (自动判断 5G/2G)，单位 kHz (BB_REG_PAGE0_F8)",
            "post_process": { "func": "reg_freq_khz" }
        }
    ],
    "_example_output": {
        "_desc": "上报数据按 valid_mask 紧凑排列",
        "IRQ0_RX_BR_END": "BR锁定、BR频点、BR_SNR、BR_GAIN等BR相关寄存器",
        "IRQ1_TX_BR_END": "TX频点、PA状态等发送相关寄存器",
        "IRQ7_RX_RDOUT": "Slot SNR、用户增益、LDPC统计等接收相关寄存器",
        "IRQ9_FREQ_SWEEP": "扫频功率、扫频时间、FS PA状态等扫频相关寄存器"
    }
}